

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tutorial 1: 10x Visium (DLPFC dataset) &mdash; Test_1 1.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/sg_gallery.css?v=d2d258e8" />
      <link rel="stylesheet" type="text/css" href="_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=292eb321"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Test_1 documentation" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Test_1
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorial 1: 10x Visium (DLPFC dataset)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Import-the-necessary-modules">Import the necessary modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Set-the-necessary-parameters">Set the necessary parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Run-FlatST">Run FlatST</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Find-the-best-performing-model">Find the best-performing model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Draw-the-result">Draw the result</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Match-colors">Match colors</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Run_umap">Run_umap</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Test_1</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Tutorial 1: 10x Visium (DLPFC dataset)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/Tutorial 1 10x Visium (DLPFC dataset).ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Tutorial-1:-10x-Visium-(DLPFC-dataset)">
<h1>Tutorial 1: 10x Visium (DLPFC dataset)<a class="headerlink" href="#Tutorial-1:-10x-Visium-(DLPFC-dataset)" title="Link to this heading"></a></h1>
<p>Here we present our re-analysis of 151673 sample of the dorsolateral prefrontal cortex (DLPFC) dataset. Maynard et al. has manually annotated DLPFC layers and white matter (WM) based on the morphological features and gene markers.This tutorial demonstrates how to identify spatial domains on 10x Visium data using FlatST.</p>
<section id="Import-the-necessary-modules">
<h2>Import the necessary modules<a class="headerlink" href="#Import-the-necessary-modules" title="Link to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">scanpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sc</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn</span><span class="w"> </span><span class="kn">import</span> <span class="n">metrics</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn</span><span class="w"> </span><span class="kn">import</span> <span class="n">mixture</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics.cluster</span><span class="w"> </span><span class="kn">import</span> <span class="n">adjusted_rand_score</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">FlatST</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tracemalloc</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics.cluster</span><span class="w"> </span><span class="kn">import</span> <span class="n">normalized_mutual_info_score</span>
</pre></div>
</div>
</div>
</section>
<section id="Set-the-necessary-parameters">
<h2>Set the necessary parameters<a class="headerlink" href="#Set-the-necessary-parameters" title="Link to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set parameters</span>
<span class="n">number_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">151507</span><span class="p">,</span> <span class="mi">151508</span><span class="p">,</span> <span class="mi">151509</span><span class="p">,</span> <span class="mi">151510</span><span class="p">,</span> <span class="mi">151669</span><span class="p">,</span> <span class="mi">151670</span><span class="p">,</span> <span class="mi">151671</span><span class="p">,</span> <span class="mi">151672</span><span class="p">,</span> <span class="mi">151673</span><span class="p">,</span> <span class="mi">151674</span><span class="p">,</span> <span class="mi">151675</span><span class="p">,</span> <span class="mi">151676</span><span class="p">]</span>
<span class="n">regin_num</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span>
<span class="n">datadir</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;/mnt/mydisk/home/chenxd/lwfx/data/1_DLPFC&#39;</span>
<span class="n">result_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;/mnt/mydisk/home/chenxd/lwfx/res/DLPCF&#39;</span>
</pre></div>
</div>
</div>
</section>
<section id="Run-FlatST">
<h2>Run FlatST<a class="headerlink" href="#Run-FlatST" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">):</span>
    <span class="n">run_num</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">slice_num</span> <span class="o">=</span> <span class="n">number_list</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
    <span class="n">target_num</span> <span class="o">=</span> <span class="n">regin_num</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
    <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;FlatST&#39;</span>
    <span class="c1"># initial</span>
    <span class="n">memory</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">run_num</span>
    <span class="n">during_time</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">run_num</span>
    <span class="n">ari_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">run_num</span>
    <span class="n">nmi_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">run_num</span>
    <span class="c1"># save res</span>
    <span class="n">new_adata</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">read_h5ad</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">datadir</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">slice_num</span><span class="si">}</span><span class="s1">.h5ad&#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">run_num</span><span class="p">):</span>
        <span class="n">tracemalloc</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="n">adata</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">read_h5ad</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">datadir</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">slice_num</span><span class="si">}</span><span class="s1">.h5ad&#39;</span><span class="p">)</span>
        <span class="n">adata</span><span class="o">.</span><span class="n">var_names_make_unique</span><span class="p">()</span>
        <span class="n">adata</span> <span class="o">=</span> <span class="n">adata</span><span class="p">[</span><span class="o">~</span><span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># Normalization</span>
        <span class="n">sc</span><span class="o">.</span><span class="n">pp</span><span class="o">.</span><span class="n">highly_variable_genes</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">flavor</span><span class="o">=</span><span class="s2">&quot;seurat_v3&quot;</span><span class="p">,</span> <span class="n">n_top_genes</span><span class="o">=</span><span class="mi">3000</span><span class="p">)</span>
        <span class="n">sc</span><span class="o">.</span><span class="n">pp</span><span class="o">.</span><span class="n">normalize_total</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">target_sum</span><span class="o">=</span><span class="mf">1e4</span><span class="p">)</span>
        <span class="n">sc</span><span class="o">.</span><span class="n">pp</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">adata</span><span class="p">)</span>

        <span class="c1"># Constructing the spatial network</span>
        <span class="n">FlatST</span><span class="o">.</span><span class="n">Cal_Spatial_Net</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">rad_cutoff</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
        <span class="n">FlatST</span><span class="o">.</span><span class="n">Stats_Spatial_Net</span><span class="p">(</span><span class="n">adata</span><span class="p">)</span>

        <span class="c1"># Running FlatST</span>
        <span class="n">adata</span> <span class="o">=</span> <span class="n">FlatST</span><span class="o">.</span><span class="n">train_FlatST</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span><span class="n">n_epochs</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="n">hidden_dims</span><span class="o">=</span><span class="p">[</span><span class="mi">610</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span><span class="n">cuda_device</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                    <span class="n">num_smooth_iterations</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">keep_percent</span><span class="o">=</span><span class="mf">0.97</span><span class="p">,</span><span class="n">initial_alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">is_distribution</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">is_early_stopping</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">adata</span> <span class="o">=</span> <span class="n">FlatST</span><span class="o">.</span><span class="n">mclust_R</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">used_obsm</span><span class="o">=</span><span class="s1">&#39;FlatST&#39;</span><span class="p">,</span> <span class="n">num_cluster</span><span class="o">=</span><span class="n">target_num</span><span class="p">)</span>

        <span class="c1"># Save relevant data</span>
        <span class="n">new_adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s1">&#39;pred_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span><span class="o">=</span><span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s1">&#39;mclust&#39;</span><span class="p">]</span>
        <span class="n">obs_df</span> <span class="o">=</span> <span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
        <span class="n">ari</span> <span class="o">=</span> <span class="n">adjusted_rand_score</span><span class="p">(</span><span class="n">obs_df</span><span class="p">[</span><span class="s1">&#39;mclust&#39;</span><span class="p">],</span> <span class="n">obs_df</span><span class="p">[</span><span class="s1">&#39;Region&#39;</span><span class="p">])</span>
        <span class="n">nmi</span> <span class="o">=</span> <span class="n">normalized_mutual_info_score</span><span class="p">(</span><span class="n">obs_df</span><span class="p">[</span><span class="s1">&#39;mclust&#39;</span><span class="p">],</span> <span class="n">obs_df</span><span class="p">[</span><span class="s1">&#39;Region&#39;</span><span class="p">])</span>
        <span class="n">ari_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ari</span>
        <span class="n">nmi_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">nmi</span>
        <span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">during</span> <span class="o">=</span> <span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span>

        <span class="n">size</span><span class="p">,</span> <span class="n">peak</span> <span class="o">=</span> <span class="n">tracemalloc</span><span class="o">.</span><span class="n">get_traced_memory</span><span class="p">()</span>
        <span class="n">tracemalloc</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

        <span class="n">memory</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">peak</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span>
        <span class="n">during_time</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">during</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Now is slice </span><span class="si">{}</span><span class="s1"> , </span><span class="si">{}</span><span class="s1"> times&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">slice_num</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;memory blocks peak:</span><span class="si">{:&gt;10.4f}</span><span class="s1"> MB&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">memory</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;time: </span><span class="si">{:.4f}</span><span class="s1"> s&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">during_time</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ARI:</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ari_list</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="s1">&#39;NMI:</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nmi</span><span class="p">))</span>

    <span class="n">new_adata</span><span class="o">.</span><span class="n">uns</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">during_time</span>
    <span class="n">new_adata</span><span class="o">.</span><span class="n">uns</span><span class="p">[</span><span class="s1">&#39;memory&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">memory</span>
    <span class="n">new_adata</span><span class="o">.</span><span class="n">uns</span><span class="p">[</span><span class="s1">&#39;ari&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ari_list</span>
    <span class="n">new_adata</span><span class="o">.</span><span class="n">uns</span><span class="p">[</span><span class="s1">&#39;nmi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nmi_list</span>
    <span class="n">new_adata</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">result_path</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">slice_num</span><span class="si">}</span><span class="s1">.h5ad&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
------Calculating spatial graph...
The graph contains 21038 edges, 3611 cells.
5.8261 neighbors per cell on average.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Tutorial_1_10x_Visium_%28DLPFC_dataset%29_7_1.png" src="_images/Tutorial_1_10x_Visium_%28DLPFC_dataset%29_7_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Tutorial_1_10x_Visium_%28DLPFC_dataset%29_7_2.png" src="_images/Tutorial_1_10x_Visium_%28DLPFC_dataset%29_7_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Size of Input:  (3611, 2910)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|██████████| 1000/1000 [00:14&lt;00:00, 68.40it/s]
R[write to console]:                    __           __
   ____ ___  _____/ /_  _______/ /_
  / __ `__ \/ ___/ / / / / ___/ __/
 / / / / / / /__/ / /_/ (__  ) /_
/_/ /_/ /_/\___/_/\__,_/____/\__/   version 6.1.1
Type &#39;citation(&#34;mclust&#34;)&#39; for citing this R package in publications.

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
fitting ...
  |======================================================================| 100%
Now is slice 151673 , 1 times
memory blocks peak:  751.8354 MB
time: 22.5458 s
ARI:0.6794280914557531 NMI:0.7721770185114232
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adata</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
AnnData object with n_obs × n_vars = 3611 × 33538
    obs: &#39;in_tissue&#39;, &#39;array_row&#39;, &#39;array_col&#39;, &#39;Region&#39;, &#39;mclust&#39;
    var: &#39;gene_ids&#39;, &#39;feature_types&#39;, &#39;genome&#39;, &#39;highly_variable&#39;, &#39;highly_variable_rank&#39;, &#39;means&#39;, &#39;variances&#39;, &#39;variances_norm&#39;
    uns: &#39;spatial&#39;, &#39;hvg&#39;, &#39;log1p&#39;, &#39;Spatial_Net&#39;
    obsm: &#39;spatial&#39;, &#39;FlatST&#39;
</pre></div></div>
</div>
</section>
<section id="Find-the-best-performing-model">
<h2>Find the best-performing model<a class="headerlink" href="#Find-the-best-performing-model" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># adata  = sc.read_h5ad(f&#39;{result_path}/{method}_{slice_num}.h5ad&#39;)</span>
<span class="n">adata</span> <span class="o">=</span> <span class="n">new_adata</span>
<span class="n">ari_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">adata</span><span class="o">.</span><span class="n">uns</span><span class="p">[</span><span class="s1">&#39;ari&#39;</span><span class="p">])</span>
<span class="n">a</span><span class="p">,</span><span class="n">a_loc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">ari_array</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">ari_array</span><span class="p">)</span>
<span class="n">b</span><span class="p">,</span><span class="n">b_loc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">ari_array</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">ari_array</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;max ARI is </span><span class="si">{:.2f}</span><span class="s1">, loc is </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">a_loc</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
max ARI is 0.68, loc is 1
</pre></div></div>
</div>
</section>
<section id="Draw-the-result">
<h2>Draw the result<a class="headerlink" href="#Draw-the-result" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The best</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">sc</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">spatial</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Region&quot;</span><span class="p">,</span><span class="s2">&quot;pred_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">a_loc</span><span class="o">+</span><span class="mi">1</span><span class="p">)],</span> <span class="n">title</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Region&quot;</span><span class="p">,</span><span class="s1">&#39;FlatST (ARI=</span><span class="si">%.2f</span><span class="s1">)&#39;</span><span class="o">%</span><span class="k">a</span>])
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Tutorial_1_10x_Visium_%28DLPFC_dataset%29_12_0.png" src="_images/Tutorial_1_10x_Visium_%28DLPFC_dataset%29_12_0.png" />
</div>
</div>
</section>
<section id="Match-colors">
<h2>Match colors<a class="headerlink" href="#Match-colors" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adata</span> <span class="o">=</span> <span class="n">adata</span><span class="p">[</span><span class="o">~</span><span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s1">&#39;Region&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
<span class="n">pred</span> <span class="o">=</span> <span class="s1">&#39;pred_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a_loc</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">dic</span> <span class="o">=</span> <span class="n">FlatST</span><span class="o">.</span><span class="n">find_region_mapping</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span><span class="n">pred</span><span class="p">)</span>
<span class="n">dic</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{2: &#39;Layer6&#39;,
 3: &#39;Layer3&#39;,
 6: &#39;Layer5&#39;,
 7: &#39;WM&#39;,
 4: &#39;Layer1&#39;,
 1: &#39;Layer2&#39;,
 5: &#39;Layer4&#39;}
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Map the numerical label of mclust to the Layer name</span>
<span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s1">&#39;mclust&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="n">pred</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">dic</span><span class="p">)</span>
<span class="c1"># Force the category order of mclust to be exactly the same as that of Region</span>
<span class="n">region_order</span> <span class="o">=</span> <span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s1">&#39;Region&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">categories</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s1">&#39;mclust&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span>
    <span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s1">&#39;mclust&#39;</span><span class="p">],</span>
    <span class="n">categories</span><span class="o">=</span><span class="n">region_order</span>  <span class="c1"># Key: Align the order with Region</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">sc</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">spatial</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Region&quot;</span><span class="p">,</span><span class="s2">&quot;mclust&quot;</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Region&quot;</span><span class="p">,</span><span class="s1">&#39;FlatST (ARI=</span><span class="si">%.2f</span><span class="s1">)&#39;</span><span class="o">%</span><span class="k">a</span>])
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Tutorial_1_10x_Visium_%28DLPFC_dataset%29_16_0.png" src="_images/Tutorial_1_10x_Visium_%28DLPFC_dataset%29_16_0.png" />
</div>
</div>
</section>
<section id="Run_umap">
<h2>Run_umap<a class="headerlink" href="#Run_umap" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">):</span>
    <span class="n">run_num</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">slice_num</span> <span class="o">=</span> <span class="n">number_list</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
    <span class="n">target_num</span> <span class="o">=</span> <span class="n">regin_num</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
    <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;FlatST&#39;</span>
    <span class="n">adata</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">read_h5ad</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">datadir</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">slice_num</span><span class="si">}</span><span class="s1">.h5ad&#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">run_num</span><span class="p">):</span>
        <span class="n">adata</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">read_h5ad</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">datadir</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">slice_num</span><span class="si">}</span><span class="s1">.h5ad&#39;</span><span class="p">)</span>
        <span class="n">adata</span><span class="o">.</span><span class="n">var_names_make_unique</span><span class="p">()</span>
        <span class="n">adata</span> <span class="o">=</span> <span class="n">adata</span><span class="p">[</span><span class="o">~</span><span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="c1"># Normalization</span>
        <span class="n">sc</span><span class="o">.</span><span class="n">pp</span><span class="o">.</span><span class="n">highly_variable_genes</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">flavor</span><span class="o">=</span><span class="s2">&quot;seurat_v3&quot;</span><span class="p">,</span> <span class="n">n_top_genes</span><span class="o">=</span><span class="mi">3000</span><span class="p">)</span>
        <span class="n">sc</span><span class="o">.</span><span class="n">pp</span><span class="o">.</span><span class="n">normalize_total</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">target_sum</span><span class="o">=</span><span class="mf">1e4</span><span class="p">)</span>
        <span class="n">sc</span><span class="o">.</span><span class="n">pp</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">adata</span><span class="p">)</span>

        <span class="c1"># Constructing the spatial network</span>
        <span class="n">FlatST</span><span class="o">.</span><span class="n">Cal_Spatial_Net</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">rad_cutoff</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>

        <span class="c1"># Running FlatST</span>
        <span class="n">adata</span> <span class="o">=</span> <span class="n">FlatST</span><span class="o">.</span><span class="n">train_FlatST</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span><span class="n">n_epochs</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="n">hidden_dims</span><span class="o">=</span><span class="p">[</span><span class="mi">610</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span><span class="n">cuda_device</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                    <span class="n">num_smooth_iterations</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">keep_percent</span><span class="o">=</span><span class="mf">0.97</span><span class="p">,</span><span class="n">initial_alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">is_distribution</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">is_early_stopping</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">adata</span> <span class="o">=</span> <span class="n">FlatST</span><span class="o">.</span><span class="n">mclust_R</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">used_obsm</span><span class="o">=</span><span class="s1">&#39;FlatST&#39;</span><span class="p">,</span> <span class="n">num_cluster</span><span class="o">=</span><span class="n">target_num</span><span class="p">)</span>

    <span class="n">adata</span> <span class="o">=</span> <span class="n">adata</span><span class="p">[</span><span class="o">~</span><span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s1">&#39;Region&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
    <span class="n">sc</span><span class="o">.</span><span class="n">pp</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">use_rep</span><span class="o">=</span><span class="s1">&#39;FlatST&#39;</span><span class="p">)</span>
    <span class="n">sc</span><span class="o">.</span><span class="n">tl</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="n">adata</span><span class="p">)</span>

    <span class="n">pred</span> <span class="o">=</span> <span class="s1">&#39;mclust&#39;</span>
    <span class="n">dic</span> <span class="o">=</span> <span class="n">FlatST</span><span class="o">.</span><span class="n">find_region_mapping</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">pred</span><span class="p">)</span>
    <span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s1">&#39;mclust&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="n">pred</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">dic</span><span class="p">)</span>
    <span class="n">region_order</span> <span class="o">=</span> <span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s1">&#39;Region&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">categories</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s1">&#39;mclust&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span>
        <span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s1">&#39;mclust&#39;</span><span class="p">],</span>
        <span class="n">categories</span><span class="o">=</span><span class="n">region_order</span>
    <span class="p">)</span>

    <span class="n">used_adata</span> <span class="o">=</span> <span class="n">adata</span><span class="p">[</span><span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s1">&#39;mclust&#39;</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;nan&#39;</span><span class="p">,]</span>
    <span class="n">used_adata</span> <span class="o">=</span> <span class="n">used_adata</span><span class="p">[</span><span class="n">used_adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s1">&#39;mclust&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()]</span>

    <span class="n">sc</span><span class="o">.</span><span class="n">tl</span><span class="o">.</span><span class="n">paga</span><span class="p">(</span><span class="n">used_adata</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="s1">&#39;mclust&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">sc</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">paga_compare</span><span class="p">(</span><span class="n">used_adata</span><span class="p">,</span> <span class="n">legend_fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">slice_num</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_FlatST&#39;</span><span class="p">,</span> <span class="n">legend_fontoutline</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
------Calculating spatial graph...
The graph contains 21038 edges, 3611 cells.
5.8261 neighbors per cell on average.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Tutorial_1_10x_Visium_%28DLPFC_dataset%29_18_1.png" src="_images/Tutorial_1_10x_Visium_%28DLPFC_dataset%29_18_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Size of Input:  (3611, 2910)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|██████████| 1000/1000 [00:14&lt;00:00, 70.97it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
fitting ...
  |                                                                      |   0%
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
  |======================================================================| 100%
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Tutorial_1_10x_Visium_%28DLPFC_dataset%29_18_7.png" src="_images/Tutorial_1_10x_Visium_%28DLPFC_dataset%29_18_7.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Test_1 documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, cxd.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>